---
title: Adobe Campaignクラシック受信者表の使用
description: データモデルを設計する際に、Adobe Campaignクラシックの標準搭載された受信者テーブルを使用する方法を説明します。
page-status-flag: never-activated
uuid: faddde15-59a1-4d2c-8303-5b3e470a0c51
contentOwner: sauviat
products: SG_CAMPAIGN/CLASSIC
audience: configuration
content-type: reference
topic-tags: schema-reference
discoiquuid: 5957b39e-c2c6-40a2-b81a-656e9ff7989c
index: y
internal: n
snippet: y
translation-type: tm+mt
source-git-commit: 8c71f54b68558178171fa30601aebf5e638db37f

---


# データモデルのベストプラクティス{#data-model-best-practices}

このドキュメントでは、データモデルを設計する際の主要な推奨Adobe Campaignについて説明します。

キャンペーン組み込みテーブルとその操作について詳しくは、「 [Campaign Classicデータモデル](../../configuration/using/about-data-model.md) 」を参照してください。

このドキュメントを読 [んで](../../configuration/using/about-schema-reference.md) 、キャンペーンスキーマを使い始めます。 この [ドキュメントで、Adobe Campaignデータベースの概念データモデルを拡張する方法を説明し](../../configuration/using/about-schema-edition.md)ます。

## 概要 {#overview}

Adobe Campaignシステムは非常に柔軟性が高く、初期実装を超えて拡張できます。 ただし、可能性は無限ですが、賢明な判断を下し、データモデルを設計する開始の強力な基盤を築くことが重要です。

このドキュメントでは、Adobe Campaignツールを適切に設計する方法を学ぶための一般的な使用例とベストプラクティスを示します。

## データモデルのアーキテクチャ {#data-model-architecture}

Adobe Campaign標準は、オンラインおよびオフラインの戦略を調整して、パーソナライズされた顧客体験を作り出すのに役立つ、強力なクロスチャネルキャンペーン管理システムです。

### 顧客中心アプローチ {#customer-centric-approach}

ほとんどの電子メールサービスプロバイダーは、リスト中心アプローチを通じて顧客と通信していますが、Adobe Campaignは、顧客とその属性の幅広い表示を活用するために、リレーショナルデータベースに依存しています。

この顧客中心アプローチは、次の図のとおりです。 灰色の **受信者** 表は、すべてが構築される主要な顧客表を表します。

![](assets/customer-centric-data-model.png)

各表の説明にアクセスするには、に進み、リソ **[!UICONTROL Admin > Configuration > Data schemas]**&#x200B;ースをリストから選択し、タブをクリック **[!UICONTROL Documentation]** します。

Adobe Campaignのデフォルトのデータモデルがこの [ドキュメントに表示されま](../../configuration/using/data-model-description.md)す。

>[!NOTE]
>
>Adobe Campaignクラシックでは、カスタム顧客テーブルを作成できます。 ただし、ほとんどの場合は、追加のテーブルや機能が事前に組み込まれている標準 [受信者](../../configuration/using/about-data-model.md#default-recipient-table) ・テーブルを利用することをお勧めします。

### Adobe Campaign {#data-for-campaign}

どのデータをAdobe Campaignに送るか マーケティングアクティビティに必要なデータを判断することが重要です。

>[!NOTE]
>
>Adobe Campaignは、データウェアハウスでもレポートツールでもありません。 したがって、可能な顧客とその関連情報をすべてAdobe Campaignにインポートしたり、レポートの作成にのみ使用されるデータをインポートしたりしないでください。

属性がAdobe Campaignに必要かどうかを判断するには、次のいずれかのカテゴリに該当するかどうかを自問します。

* セグメント化に使用する **属性**
* 属性を使用した **データ管理** (集計計算など)
* パーソナライゼーションに使用され **る属性**

これらのいずれにも該当しない場合は、この属性がAdobe Campaignで必要になりません。

### データタイプの選択 {#data-types}

システムの優れたアーキテクチャとパフォーマンスを確保するには、次のベストプラクティスに従って、データをAdobe Campaignで設定します。

* 大きなテーブルには、数値フィールドが含まれ、参照テーブルへのリンクが含まれていることがよくあります(値のリストを扱う場合)。
* expr属 **性を使用すると** 、スキーマ属性を、テーブル内の物理的な設定値ではなく、計算済みのフィールドとして定義できます。 これにより、両方の値を格納する必要なく、異なる形式（例えば、年齢や生年月日）で情報にアクセスできます。 これは、フィールドの重複を避けるための良い方法です。 例えば、受信者テーブルでは、既に電子メールフィールドに存在する式をドメインに使用します。
* ただし、式の計算が複雑な場合は、 **expr** 属性を使用しないでください。この属性は、実行時の計算がクエリのパフォーマンスに影響を与える可能性があるためです。
* この **XML型は** 、作成するフィールドが多すぎないようにするのに適しています。 ただし、データベース内でCLOB列を使用するので、ディスク領域も消費されます。 また、複雑なSQLクエリを引き起こし、パフォーマンスに影響を与えます。
* 文字列フィールドの長 **さは** 、常に列で定義する必要があります。 デフォルトでは、Adobe Campaignの最大長は255ですが、サイズが短い長さを超えないことが既にわかっている場合は、フィールドを短くすることをお勧めします。
* ソース・システムのサイズが過大評価され、到達しないことが確実な場合、ソース・システムのAdobe Campaignよりもフィールドの方が小さくなることは許容できる。 これは、文字列が短いか、整数が小さいことを意味します。Adobe Campaignは

### フィールドの選択 {#choice-of-fields}

ターゲット設定またはパーソナライゼーションの目的を持つフィールドは、テーブルに保存する必要があります。 つまり、パーソナライズされた電子メールの送信にフィールドを使用しない場合や、クエリの条件として使用しない場合は、無用な場合にディスク領域を消費します。

ハイブリッドインスタンスおよびオンプレミスインスタンスの場合、FDA(Federated Data Access、外部データにアクセスできるオプションの機能)は、キャンペーンプロセス中に「その場で」フィールドを追加する必要性をカバーします。 インポートが必要な場合は、すべてをインポートする必要はありません。FDA For more on this, see [About Federated Data Access](../../platform/using/about-fda.md).

### キーの選択 {#choice-of-keys}

ほとんどのテーブルで **は** 、デフォルトで定義されている自動処理に加えて、論理キーやビジネスキー（アカウント番号、クライアント番号など）を追加することを検討する必要があります。 後で、インポート/調整またはデータパッケージに使用できます。 For more on this, see [Identifiers](#identifiers).

パフォーマンスを高めるには、効率的なキーが不可欠です。 数値データ型は、常にテーブルのキーとしてお勧めします。

SQLServerデータベースの場合は、パフォーマンスが必要な場合は、「クラスタ化インデックス」の使用を検討できます。 アドビではこの処理を行わないので、SQLで作成する必要があります。

### 専用テーブルスペース {#dedicated-tablespaces}

スキーマの表領域属性を使用すると、表の専用の表領域を指定できます。

インストールウィザードを使用すると、オブジェクトを種類（データ、一時、インデックス）別に保存できます。

専用のテーブルスペースは、パーティション化、セキュリティ・ルールに適しており、流動的で柔軟な管理、最適化、パフォーマンスが向上しています。

## 識別子 {#identifiers}

Adobe Campaignリソースには3つの識別子があり、識別子を追加できます。

次の表に、これらの識別子とその目的を示します。

| ID | 説明 | ベストプラクティス |
|--- |--- |--- |
| ID | <ul><li>IDは、Adobe Campaign表の物理主キーです。 標準搭載のテーブルの場合、シーケンスから生成された32ビットの数値です</li><li>この識別子は、通常、特定のAdobe Campaignインスタンスに対して一意です。 </li><li>自動生成されたIDは、ユーザー定義で表示できます。スキーマ定義では、 autopk=&quot;true&quot; *属性を検索し* ます。</li></ul> | <ul><li>自動生成された識別子は、ワークフローやパッケージ定義で参照として使用しないでください。</li><li>IDが常に増加する数であると想定しないでください。</li><li>標準搭載のテーブルのIDは32ビットの数値で、この型は変更しないでください。 この番号は、セクション内の同じ名前の「シーケンス」から取得されます。</li></ul> |
| 名前（または内部名） | <ul><li>この情報は、テーブル内のレコードの一意の識別子です。 この値は手動で更新でき、通常は生成された名前で更新できます。</li><li>この識別子は、別のインスタンスにデプロイした場合に値を保持し、Adobe Campaignを空にすることはできません。</li></ul> | <ul><li>オブジェクトを別のAdobe Campaignにデプロイする場合は、環境で生成されるレコード名を変更します。</li><li>オブジェクトに名前空間属性(*スキーマ* など)がある場合、この共通名前空間は、作成されたすべてのカスタムオブジェクトで使用されます。 一部の予約済み名前空間は使用しないでください。 *nms*、 *xtk*。</li><li>オブジェクトに名前空間(*workflow* 、 *配信* )がない場合、この名前空間概念は内部名オブジェクトの接頭辞として追加されます。namespaceMyObjectName **。</li><li>スペース&quot;&quot;、セミコロン&quot;:&quot;、ハイフン&quot;-&quot;などの特殊文字は使用しないでください。 これらの文字はすべて、アンダースコア「_」（文字を使用できます）で置き換えられます。 例えば、「abc-def」と「abc:def」は「abc_def」として保存され、相互に上書きされます。</li></ul> |
| ラベル | <ul><li>ラベルは、オブジェクトまたはレコードのビジネス識別子です(Adobe Campaign内)。</li><li>このオブジェクトでは、スペースと特殊文字を使用できます。</li><li>レコードの一意性を保証するものではありません。</li></ul> | <ul><li>オブジェクトのラベルの構造を決定することをお勧めします。</li><li>これは、ユーザーにとってレコードやオブジェクトを識別する、最も使いやすいAdobe Campaignです。</li></ul> |

## カスタム内部キー {#custom-internal-keys}

プライマリ・キーは、Adobe Campaignで作成されたすべてのテーブルに必要です。

ほとんどの組織は、外部システムからレコードを読み込んでいます。 受信者テーブルの物理キーは「id」属性ですが、カスタムキーを特定することもできます。

このカスタムキーは、外部システムフィードシステムの実際のレコードのプライマリキーです。Adobe Campaign

標準搭載のテーブルにオートパックと内部キーの両方が含まれている場合、内部キーは物理データベーステーブルの一意のインデックスとして設定されます。

カスタムテーブルを作成する場合は、次の2つのオプションがあります。
* 自動生成されたキー(id)と内部キー(custom)の組み合わせ。 このオプションは、システムキーが複合キーであるか、整数でない場合に興味深いものです。 整数は、大きなテーブルで高いパフォーマンスを得るとともに、他のテーブルとの結合を行います。
* プライマリ・キーを外部システムのプライマリ・キーとして使用する。 異なるシステム間で一貫したキーを使用して、データのインポートとエクスポートのアプローチを簡素化するので、このソリューションをお勧めします。 キーの名前が「id」で、（自動生成ではなく）外部の値が入力される場合、自動実行は無効にする必要があります。

>[!IMPORTANT]
>
>オートパックは、参照として使用しないでください(ワークフロー)。

## シーケンス {#sequences}

Adobe Campaignのプライマリキーは、あらかじめ用意されているすべてのテーブルの自動生成IDで、カスタムテーブルでも同じIDを使用できます。 詳しくは、[この節](#identifiers)を参照してください。

この値は、「シーケンス」と呼ばれるシーケ **ンス**（番号シーケンスの生成に使用されるデータベースオブジェクト）から取得されます。

シーケンスには次の2種類があります。
* **共有**:複数のテーブルで同じシーケンスからIDが選択される場合があります。 つまり、あるテーブルでID「X」が使用されている場合、同じシーケンスを共有する他のテーブルで、そのID「X」のレコードが存在することはありません。 **XtkNewIdは** 、Adobe Campaign。
* **専用**:シーケンスからIDを選択しているテーブルは1つだけです。 通常、シーケンス名にはテーブル名が含まれます。

>[!IMPORTANT]
>
>シーケンスは32ビットの整数値で、使用可能な値の最大数は有限です。21億4000万ドル 最大値に達した後、シーケンスは0に戻り、IDを再利用します。
>
>古いデータが削除されない場合は、一意のキー違反が発生し、プラットフォームの正常性と使用が阻害されます。 Adobe Campaignが通信を送信できない(配信ログテーブルに影響が出る)場合、パフォーマンスに大きな影響が出ます。

したがって、顧客がログの保存期間が180日の場合、毎年60億通の電子メールを送信すると、4か月でIDが不足します。 このような問題を回避するには、ボリュームに応じてパージ設定を行う必要があります。 詳しくは、[この節](#data-retention)を参照してください。

主キーをautoPKとしてAdobe Campaignしてカスタムテーブルを作成する場合、カスタム専用シーケンスをそのテーブルに体系的に関連付ける必要があります。

デフォルトでは、カスタムシーケンスの値は+1,000 ～ +2.1BBです。 技術的には、負のIDを有効にすることで、4BBの全範囲を取得できます。 これは注意して使用し、負の数から正の数に渡すと1つのIDが失われます。通常、生成されたSQLAdobe Campaignのレコード0は無視されます。

**関連トピック：**
* シーケンスの自動生成機能に **ついて詳しくは** 、このドキュメントを参照し [てください](https://helpx.adobe.com/jp/campaign/kb/sequence_auto_generation.html)。
* シーケンスの消耗について詳しくは、このビデオをご覧 [くださ](https://helpx.adobe.com/customer-care-office-hours/campaign/sequences-exhaustion-campaign-classic.html)い。

## インデックス {#indexes}

パフォーマンスにはインデックスが不可欠です。 キーを宣言すると、スキーマのフィールドにインデックスが自動的に作成されます。 また、キーを使用しないクエリのインデックスをさらに宣言することもできます。

パフォーマンスが向上する可能性があるので、追加のインデックスを定義することをお勧めします。

ただし、次の点に注意してください。

* インデックスの使用がアクセスパターンに結び付けられています。 インデックス作成の最適化は、多くの場合、データベース設計の重要な部分であり、専門家が処理する必要があります。 インデックスの追加は、多くの場合、データベースのメンテナンスに関連する反復的なワークフローです。 パフォーマンスの問題に対処するため、時間の経過と共に、手順を追って実行されます。
* インデックスは、（インデックス自体を保存するために）テーブル全体のサイズを大きくします。
* 列にインデックスを追加すると、データ読み取りアクセス(SELECT)のパフォーマンスが向上しますが、データ書き込みアクセス(UPDATE)のパフォーマンスが低下する可能性があります。
* これは、データの挿入時のパフォーマンスに影響するので、インデックスのサイズと数を制限する必要があります。
* 必要がない場合はインデックスを追加しないでください。 必須であることを確認し、クエリ（テストと学習）の全体的なパフォーマンスを向上させます。
* 一般的に、クエリが10%を超えるレコードを返さないことを知っている場合は、インデックスが効率的です。
* 定義するインデックスを慎重に選択します。
* 既製のテーブルからネイティブインデックスを削除しないでください。

<!--When you are performing an initial import with very high volumes of data insert in Adobe Campaign database, it is recommended to run that import without custom indexes at first. It will allow to accelerate the insertion process. Once you’ve completed this important import, it is possible to enable the index(es).-->

### 例

インデックスの管理は非常に複雑になる可能性があるので、その仕組みを理解することが重要です。 この複雑さを説明するために、姓と名でフィルタリングして受信者を検索するなど、基本的な例を見てみましょう。 手順は次のとおりです。
1. データベース内のすべてのリストを格納する受信者に移動します。 詳しくは、「管理」を参照し [てください](../../platform/using/managing-profiles.md)。
1. フィールドを右クリック **[!UICONTROL First name]** します。
1. 選択 **[!UICONTROL Filter on this field]**.

   ![](assets/data-model-index-example.png)

1. フィールドに対してこの操作を繰り **[!UICONTROL Last name]** 返します。

対応する2つのフィルターが画面の上に追加されます。

![](assets/data-model-index-search.png)

様々なフィルター条件に従って、およびフィー **[!UICONTROL First name]** ルドに対し **[!UICONTROL Last name]** て検索フィルターを実行できるようになりました。

インデックスを追加すると、これらのフィルターの検索を高速化できます。 どのインデックスを使用する必要がありますか。

>[!NOTE]
>
>この例は、PostgreSQLデータベースを使用するホストされた顧客に適用されます。

次の表に、最初の列に表示されるアクセスパターンに従って、以下に示す3つのインデックスが使用されるか、使用されないかを示します。

| 検索条件 | インデックス1（姓と名） | 索引2（名のみ） | インデックス3（姓のみ） | コメント |
|--- |--- |--- |--- |--- |
| 名が「Johnny」に等しい | 使用済み | 使用済み | 未使用 | 名はインデックス1の最初の位置にあるので、いずれにせよ使用されます。姓に基準を追加する必要はありません。 |
| 名は「Johnny」、姓は「Smith」に等しい | 使用済み | 未使用 | 未使用 | 両方の属性が同じクエリで検索されるので、両方の属性を結合するインデックスのみが使用されます。 |
| 姓が「Smith」に等しい | 未使用 | 未使用 | 使用済み | インデックス内の属性の順序が考慮されます。 この順序に一致しない場合、インデックスが使用されない可能性があります。 |
| 「Joh」を持つ名開始 | 使用済み | 使用済み | 未使用 | 「左検索」はインデックスを有効にします。 |
| 名が「nny」で終わる | 未使用 | 未使用 | 未使用 | 「右検索」はインデックスを無効にし、フルスキャンを実行します。 特定のインデックスタイプの中には、この使用例を扱うものもありますが、デフォルトでは使用できないものもあります(Adobe Campaign)。 |
| 名に「John」を含む | 未使用 | 未使用 | 未使用 | これは、「左」検索と「右」検索の組み合わせです。 後者の場合はインデックスが無効になり、フルスキャンが実行されます。 |
| 名が「john」に等しい | 未使用 | 未使用 | 未使用 | インデックスでは大文字と小文字が区別されます。 大文字と小文字を区別しないようにするには、「upper(firstname)」のようなSQL関数を含む特定のインデックスを作成する必要があります。 「unaccent(firstname)」など、他のデータ変換でも同じ処理を行う必要があります。 |

## リンクと基数 {#links-and-cardinality}

### リンク {#links}

大きなテーブルの「独自の」整合性に注意してください。 「独自の」整合性でワイド・テーブルを持つレコードを削除すると、インスタンスが停止する場合があります。 テーブルはロックされ、削除が1つずつ行われます。 このため、ボリュームの大きい子テーブルには「中間」の整合性を使用することをお勧めします。

リンクを外部結合として宣言するのは、パフォーマンスには適していません。 ゼロIDレコードは外部結合機能をエミュレートします。 リンクで自動実行を使用する場合、外部結合を宣言する必要はありません。

ワークフロー内の任意のテーブルを結合できますが、リソース間の共通リンクをデータ構造の定義で直接定義することをお勧めします。

リンクは、テーブル内の実際のデータと整列して定義する必要があります。 誤った定義は、例えば予期せぬレコードの複製など、リンクを介して取得したデータに影響を与える可能性があります。

リンクにテーブル名を使用して名前を付けます。リンク名は、遠隔テーブルの内容を理解するのに役立ちます。

「id」をサフィックスとしてリンクに名前を付けないでください。 例えば、「transactionId」ではなく「transaction」という名前を付けます。

デフォルトでは、Adobe Campaignは外部テーブルの主キーを使用してリンクを作成します。 より明確にするには、リンク定義で結合を明示的に定義することをお勧めします。

リンクで使用される属性にインデックスが追加されます。

作成者リンクと最終変更者リンクは、多くのテーブルに存在します。 この情報がビジネスで使用されていない場合は、リンク上で属性noDbIndexを使用してインデックスを無効にできます。

### カーディナリティ {#cardinality}

リンクを設計する場合は、1-1関係が宣言されているときに、ターゲットレコードが一意であることを確認します。 それ以外の場合は、1つしか期待されない場合に、結合が複数のレコードを返す可能性があります。 この結果、「クエリが予想以上に多くの行を返す」という配信の準備中にエラーが発生します。 リンク名をターゲットスキーマ

(1)側のスキーマに基数(1 ～ N)を含むリンクを定義します。 例えば、関係受信者(1) - (N)トランザクションは、トランザクションスキーマで定義する必要があります。

デフォルトでは、リンクの基数の逆は(N)です。 リンク定義にrevCardinality=&#39;single&#39;属性を追加することで、リンク(1 ～ 1)を定義できます。

リバースリンクがユーザに表示されない場合は、リンク定義revLink=&#39;_NONE_&#39;を使用して非表示にできます。 たとえば、トランザクションから最後に完了したトランザクションへのリンクを受信者から定義するのが良い例です。 受信者から最後のトランザクションへのリンクのみが表示され、トランザクションテーブルに逆リンクを表示する必要はありません。

外部結合(1 ～ 0 ～ 1)を実行するリンクは、システムのパフォーマンスに影響を与えるので、注意して使用する必要があります。

## データ保持：クリーンアップと削除 {#data-retention}

Adobe Campaignは、データウェアハウスでもレポートツールでもありません。 したがって、データベースソリューションのパフォーマンスを高めるために、Adobe Campaignの増大を抑制する必要があります。 これを達成するには、以下のベストプラクティスに従うと役に立ちます。

デフォルトでは、Adobe Campaign配信とトラッキングログの保存期間は180日です。 クリーンアップ処理が実行され、それより古いログが削除されます。

* ログを長く保存する場合は、データベースのサイズと送信されるメッセージの量に応じて、この決定を慎重に行う必要があります。 注意：Adobe Campaignシーケンスは32ビット整数です。
* 使用可能なIDをすべて消費するリスクを制限するため、これらの表に一度に10億件を超えるレコード（21億4000万IDの約50%）を含めないことをお勧めします。 これは、一部のお客様が180日未満の保存期間を短くするために必要です。

>[!IMPORTANT]
>
>カスタムテーブルは、標準のクリーンアップ処理では削除されません。 この処理は1日目には必須ではありませんが、パフォーマンスの問題を引き起こす可能性があるので、カスタム表のパージ処理を必ず作成してください。

レコードの必要性を最小限に抑えるためのソリューションがいくつか用意されています。Adobe Campaign:
* データウェアハウス内のデータをAdobe Campaign外でエクスポート
* マーケティングの実践に十分であると同時に、使用するスペースを減らす集計値を生成します。 例えば、最後の購入を追跡するために、Adobe Campaign内の完全な顧客トランザクション履歴は必要ありません。

「deleteStatus」属性は、スキーマで宣言できます。 レコードを削除済みとしてマークし、クリーンアップタスクで削除を延期する方が効率的です。

## パフォーマンス {#performance}

パフォーマンスをいつでも向上させるには、次のベストプラクティスに従ってください。

### 一般的な推奨事項 {#general-recommendations}

* 「次を含む」などの操作は使用しないでください。クエリ 何を求め、フィルタリングを行うかがわかっている場合は、「EQUAL TO」などの特定のフィルタ演算子を使用して同じ条件を適用します。
* データをインデックスで作成する際は、インデックスのないフィールドとの結合を避けてください。ワークフローで。
* インポートやエクスポートのようなプロセスが業務時間外に発生することを確認します。
* すべての日別アクティビティのスケジュールがあることを確認し、スケジュールに従います。
* 日別のプロセスの1つまたは複数が失敗し、その同じ日に実行する必要がある場合は、手動プロセスが開始されたときに競合するプロセスが実行されていないことを確認します。システムのパフォーマンスに影響を与える可能性があります。
* 読み込みプロセス中、または手動のキャンペーンが実行されている場合は、毎日のプロセスが実行されないことを確認します。
* 各行のフィールドを複製する代わりに、1つまたは複数の参照テーブルを使用します。 キーと値のペアを使用する場合は、数値キーを選択することをお勧めします。
* 短い文字列は引き続き使用できます。 参照テーブルが外部システムに既に配置されている場合、同じテーブルを再利用すると、データをシステムと統合しやすくなります。Adobe Campaign

### 1対多の関係 {#one-to-many-relationships}

* データデザインは、ユーザビリティと機能に影響を与えます。 多くの1対多の関係を使用してデータモデルを設計する場合、ユーザーがアプリケーションで意味のあるロジックを作成するのが難しくなります。 1対多のフィルターロジックは、技術的でないマーケターが正しく構築し、理解するのが困難な場合があります。
* すべての重要なフィールドを1つのテーブルに含めると、ユーザーが必要なフィールドを簡単に作成できるので、便利です。クエリ また、結合を避けることができる場合に、一部のフィールドをテーブルに重複するのも、パフォーマンスが向上する場合があります。
* 組み込み機能の中には、1対多の関係(オファーの重み付けの式や配信など)を参照できないものもあります。

## 大きいテーブル {#large-tables}

Adobe Campaignは、サードパーティのデータベースエンジンに依存しています。 サイズの大きいテーブルのパフォーマンスを最適化する場合は、プロバイダによっては特定のデザインが必要になる場合があります。

大きなテーブルと複雑な結合を使用してデータモデルを設計する際に従う必要がある、いくつかの一般的なベストプラクティスを以下に示します。

* 追加のカスタム受信者テーブルを使用する場合は、各ログテーブルのマッピング専用のログテーブルがあることを確認してください。
* 特に未使用の列を識別して、列の数を減らします。
* 複数の条件や複数の列での結合など、複雑な結合を避け、データモデルの関係を最適化します。
* 結合キーの場合、文字列ではなく常に数値データを使用します。
* ログの保存の深さをできる限り減らします。 より深い履歴が必要な場合は、集計の計算やカスタムログテーブルの処理を行って、より大きな履歴を保存できます。

### テーブルのサイズ {#size-of-tables}

テーブルサイズは、レコード数とレコードあたりの列数の組み合わせです。 両方とも、パフォーマンスに影響を与える可能性があります。クエリ

* 小さ **いテーブルは** 、配信テーブルに似ています。
* 中サ **イズのテーブル** は、受信者テーブルと同じサイズです。 顧客1人につき1件のレコードがあります。
* 大き **いテーブルは** 、部分一致のログテーブルに似ています。 顧客ごとに多くの記録があります。
例えば、データベースに1,000万件の受信者が含まれている場合、部分一致ログテーブルには約1億～2,000万件の配信が含まれ、メッセージテーブルには数千件のレコードが含まれます。

PostgreSQLでは、 [TOASTメカニズムを避けるために行が8 KBを超えてはなりません](https://wiki.postgresql.org/wiki/TOAST) 。 したがって、システム（メモリとCPU）の最適なパフォーマンスを維持するために、列の数と各行のサイズをできる限り小さくするようにしてください。

行数はパフォーマンスにも影響します。 Adobe Campaignデータベースは、ターゲット設定やパーソナライゼーションの目的で積極的に使用されない履歴データを格納するように設計されていません。これは、運用データベースです。

行数の多さに関連するパフォーマンスの問題を防ぐには、必要なレコードのみをデータベースに保存します。 その他のレコードは、サードパーティのData Warehouseにエクスポートし、データベースの運用Adobe Campaignから削除します。

テーブルのサイズに関するいくつかのベストプラクティスを示します。

* フィールド数が少なく、数値データが多い大きなテーブルをデザインします。
* 大量の列を使用しない(例：Int64)を使用して、ブール値のような小さな数値を格納します。
* テーブル定義から、使用されていない列を削除します。
* 履歴データや非アクティブなデータは、Adobe Campaignデータベースに保存しないでください（書き出しとクリーンアップ）。

次に例を示します。

![](assets/transaction-table-example.png)

この例では、次のようになります。
* 「 *Transaction* 」表と「 *Transaction Item* 」表は大きいです。1千万以上。
* 「 *Product* 」と「 *Store* 」の表は小さくなります。1万未満。
* 製品のラベルと参照が製品テーブルに配置され *ました* 。
* トランザク *ション品目テーブルには* 、数値である製品テーブルへ ** のリンクのみが含まれます。

<!--For more detailed best practices on how to optimize the database design for larger volumes, see [Campaign Classic Data model Best practices](https://helpx.adobe.com/campaign/kb/acc-data-model-best-practices.html).-->